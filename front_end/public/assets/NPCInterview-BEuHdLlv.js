import{R as $,f as I,r as w,ar as H,o as j,c as x,a as r,w as l,b as k,al as V,am as C,d as P,K as E,ab as q,_ as R,ay as T,ad as Q,a8 as Y,az as G}from"./index-CpaKEeMo.js";import{R as U}from"./index-CoDWtlbs.js";import{L as K}from"./index-FFRmgr_N.js";import"./index-xvabcI5u.js";import{a as J,C as W}from"./index-Ba4kjeJb.js";import{N as X}from"./index-OqzX4nly.js";import{a as Z}from"./index-CJfc-XpA.js";import{C as ee}from"./index-BgladKTd.js";import{B as te}from"./index-DhOvqBWh.js";import"./use-route-Cm_xussw.js";import"./use-placeholder-BvAxgC0s.js";import"./request-M96MMQ4W.js";var B={},c={};Object.defineProperty(c,"__esModule",{value:!0});c.trim=c.isObject=c.isNil=c.isNan=c.size=c.isString=c.validateLocale=c.splitSentences=void 0;var ne=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return t.replace(/\.+/g,".|").replace(/\?/g,"?|").replace(/\!/g,"!|").split("|").map(function(e){return F(e)}).filter(Boolean)};c.splitSentences=ne;var se=/^(?:(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))$|^((?:[a-z]{2,3}(?:(?:-[a-z]{3}){1,3})?)|[a-z]{4}|[a-z]{5,8})(?:-([a-z]{4}))?(?:-([a-z]{2}|\d{3}))?((?:-(?:[\da-z]{5,8}|\d[\da-z]{3}))*)?((?:-[\da-wy-z](?:-[\da-z]{2,8})+)*)?(-x(?:-[\da-z]{1,8})+)?$|^(x(?:-[\da-z]{1,8})+)$/i,ie=function(t){return typeof t!="string"?!1:se.test(t)};c.validateLocale=ie;var D=function(t){return typeof t=="string"||t instanceof String};c.isString=D;var ae=function(t){return t&&Array.isArray(t)&&t.length?t.length:0};c.size=ae;var oe=function(t){return typeof t=="number"&&isNaN(t)};c.isNan=oe;var re=function(t){return t==null};c.isNil=re;var le=function(t){return Object.prototype.toString.call(t)==="[object Object]"};c.isObject=le;var F=function(t){return D(t)?t.trim():""};c.trim=F;Object.defineProperty(B,"__esModule",{value:!0});var A=B.default=void 0,i=c;function ce(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(s,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,n.key,n)}}function fe(s,t,e){return t&&ue(s.prototype,t),s}var ve=function(){function s(){ce(this,s),this.browserSupport="speechSynthesis"in window&&"SpeechSynthesisUtterance"in window,this.synthesisVoice=null}return fe(s,[{key:"init",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(u,f){e.browserSupport||f("Your browser does not support Speech Synthesis");var m=(0,i.isNil)(n.listeners)?{}:n.listeners,y=(0,i.isNil)(n.splitSentences)?!0:n.splitSentences,_=(0,i.isNil)(n.lang)?void 0:n.lang,g=(0,i.isNil)(n.volume)?1:n.volume,o=(0,i.isNil)(n.rate)?1:n.rate,a=(0,i.isNil)(n.pitch)?1:n.pitch,p=(0,i.isNil)(n.voice)?void 0:n.voice;Object.keys(m).forEach(function(v){var S=m[v],N=function(d){S&&S(d)};v!=="onvoiceschanged"&&(speechSynthesis[v]=N)}),e._loadVoices().then(function(v){m.onvoiceschanged&&m.onvoiceschanged(v),!(0,i.isNil)(_)&&e.setLanguage(_),!(0,i.isNil)(p)&&e.setVoice(p),!(0,i.isNil)(g)&&e.setVolume(g),!(0,i.isNil)(o)&&e.setRate(o),!(0,i.isNil)(a)&&e.setPitch(a),!(0,i.isNil)(y)&&e.setSplitSentences(y),u({voices:v,lang:e.lang,voice:e.voice,volume:e.volume,rate:e.rate,pitch:e.pitch,splitSentences:e.splitSentences,browserSupport:e.browserSupport})}).catch(function(v){f(v)})})}},{key:"_fetchVoices",value:function(){return new Promise(function(e,n){setTimeout(function(){var u=speechSynthesis.getVoices();return(0,i.size)(u)>0?e(u):n("Could not fetch voices")},100)})}},{key:"_loadVoices",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10;return this._fetchVoices().catch(function(u){if(n===0)throw u;return e._loadVoices(n-1)})}},{key:"hasBrowserSupport",value:function(){return this.browserSupport}},{key:"setVoice",value:function(e){var n,u=speechSynthesis.getVoices();if((0,i.isString)(e)&&(n=u.find(function(f){return f.name===e})),(0,i.isObject)(e)&&(n=e),n)this.synthesisVoice=n;else throw"Error setting voice. The voice you passed is not valid or the voices have not been loaded yet."}},{key:"setLanguage",value:function(e){if(e=e.replace("_","-"),(0,i.validateLocale)(e))this.lang=e;else throw"Error setting language. Please verify your locale is BCP47 format (http://schneegans.de/lv/?tags=es-FR&format=text)"}},{key:"setVolume",value:function(e){if(e=parseFloat(e),!(0,i.isNan)(e)&&e>=0&&e<=1)this.volume=e;else throw"Error setting volume. Please verify your volume value is a number between 0 and 1."}},{key:"setRate",value:function(e){if(e=parseFloat(e),!(0,i.isNan)(e)&&e>=0&&e<=10)this.rate=e;else throw"Error setting rate. Please verify your volume value is a number between 0 and 10."}},{key:"setPitch",value:function(e){if(e=parseFloat(e),!(0,i.isNan)(e)&&e>=0&&e<=2)this.pitch=e;else throw"Error setting pitch. Please verify your pitch value is a number between 0 and 2."}},{key:"setSplitSentences",value:function(e){this.splitSentences=e}},{key:"speak",value:function(e){var n=this;return new Promise(function(u,f){var m=e.text,y=e.listeners,_=y===void 0?{}:y,g=e.queue,o=g===void 0?!0:g,a=(0,i.trim)(m);(0,i.isNil)(a)&&u(),!o&&n.cancel();var p=[],v=n.splitSentences?(0,i.splitSentences)(a):[a];v.forEach(function(S,N){var z=N===(0,i.size)(v)-1,d=new SpeechSynthesisUtterance;n.synthesisVoice&&(d.voice=n.synthesisVoice),n.lang&&(d.lang=n.lang),n.volume&&(d.volume=n.volume),n.rate&&(d.rate=n.rate),n.pitch&&(d.pitch=n.pitch),d.text=S,Object.keys(_).forEach(function(b){var h=_[b],M=function(O){h&&h(O),b==="onerror"&&f({utterances:p,lastUtterance:d,error:O}),b==="onend"&&z&&u({utterances:p,lastUtterance:d})};d[b]=M}),p.push(d),speechSynthesis.speak(d)})})}},{key:"pending",value:function(){return speechSynthesis.pending}},{key:"paused",value:function(){return speechSynthesis.paused}},{key:"speaking",value:function(){return speechSynthesis.speaking}},{key:"pause",value:function(){speechSynthesis.pause()}},{key:"resume",value:function(){speechSynthesis.resume()}},{key:"cancel",value:function(){speechSynthesis.cancel()}}]),s}(),pe=ve;A=B.default=pe;function L(s){const t=new A;if(!t.hasBrowserSupport()){$("浏览器不支持文字转音频");return}t.init({volume:.6,lang:"zh-CN",rate:1,pitch:1,voice:"Microsoft Yaoyao - Chinese (Simplified, PRC)",listeners:{}}).then(()=>{}).catch(e=>{console.error("初始化时发生错误 : ",e)}),t.speak({text:s}).then(()=>{console.log("Success !")}).catch(e=>{console.error("An error occurred :",e)})}const de=I({__name:"NPCVideoChat",props:{questions:{},isEnd:{type:Function}},setup(s){const t=w(),e={audio:!0,video:!0},n=w(!0);async function u(){try{const g=await navigator.mediaDevices.getUserMedia(e);t.value.srcObject=g,t.value.play(),f=0,n.value=!1,m.value=!1,s.isEnd(!1),L("人机面试开始，在听完并回答完问题后，即可点击下一题继续面试"),y()}catch(g){console.error(g)}}let f=0;const m=w(!1),y=function(){f<s.questions.length?L(`问题${f+1}:`+s.questions[f++].questionText):(L("面试结束，请自行查看答案"),m.value=!0,s.isEnd(!0))},_=function(){const g=t.value.srcObject;for(const o of g.getTracks())o.stop();t.value.srcObject=null,n.value=!0};return H(()=>{t.value.srcObject&&_()}),(g,o)=>{const a=q,p=U,v=ee,S=te;return j(),x(E,null,[r(p,{justify:"center"},{default:l(()=>[r(a,{name:"volume-o",class:"npc",size:"4rem"})]),_:1}),r(p,{justify:"center",gutter:"50"},{default:l(()=>[r(v,null,{default:l(()=>[k("video",{class:"localVideo",ref_key:"localVideo",ref:t},null,512)]),_:1}),r(v,null,{default:l(()=>[r(p,{justify:"center"},{default:l(()=>[V(r(S,{class:"start-btn title",onClick:u},{default:l(()=>o[0]||(o[0]=[P("开始面试")])),_:1},512),[[C,n.value]])]),_:1}),r(p,{justify:"center"},{default:l(()=>[V(r(S,{class:"next-btn title",onClick:y},{default:l(()=>o[1]||(o[1]=[P("下一题")])),_:1},512),[[C,!n.value&&!m.value]])]),_:1}),r(p,{justify:"center"},{default:l(()=>[V(r(S,{class:"stop-btn title",onClick:_},{default:l(()=>o[2]||(o[2]=[P("关闭摄像头")])),_:1},512),[[C,!n.value]])]),_:1})]),_:1})]),_:1})],64)}}}),he=R(de,[["__scopeId","data-v-5554bc25"]]),me={class:"overview"},ge={class:"title"},ye={class:"tip title"},_e={class:"answer"},Se={class:"container"},we=I({__name:"NPCInterview",props:{setID:String},setup(s){const t=w(!1),e=w([]),n=w(!1),u=w(!1),f=w(!1),m=w([]),y=w("题目"),_=async()=>{try{if(s.setID){const{questions:o,title:a}=await Z(s.setID);m.value=o,y.value=a,f.value=!1,u.value=!0}else{$("无题库ID");return}}catch(o){console.error(o),n.value=!1,f.value=!0}},g=function(o){t.value=o};return(o,a)=>{const p=q,v=X,S=G,N=W,z=J,d=K,b=U;return j(),x(E,null,[r(v,{onClickLeft:a[0]||(a[0]=h=>o.$router.go(-1)),onClickRight:a[1]||(a[1]=h=>o.$router.push("/studentHome"))},{left:l(()=>[r(p,{name:"arrow-left",color:"#323233"})]),title:l(()=>a[5]||(a[5]=[k("h1",{class:"top title"},"人机面试",-1)])),right:l(()=>[r(p,{name:"wap-home-o",color:"black"})]),_:1}),r(b,{justify:"center"},{default:l(()=>[k("div",me,[k("h1",ge,T(y.value),1),r(b,{justify:"center"},{default:l(()=>[r(d,{loading:n.value,"onUpdate:loading":a[3]||(a[3]=h=>n.value=h),finished:u.value,error:f.value,"onUpdate:error":a[4]||(a[4]=h=>f.value=h),"error-text":"请求失败，点击重新加载",onLoad:_,class:"question"},{default:l(()=>[V(k("h1",ye,"在面试结束后会在此处展示答案",512),[[C,!t.value]]),V(r(z,{modelValue:e.value,"onUpdate:modelValue":a[2]||(a[2]=h=>e.value=h)},{default:l(()=>[(j(!0),x(E,null,Q(m.value,h=>(j(),Y(N,{key:h.id,class:"title",title:h.questionText,name:h.id},{default:l(()=>[r(S,{name:"answer",width:"0.9rem",height:"0.9rem"}),k("span",_e,T(h.correctAnswer),1)]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"]),[[C,t.value]])]),_:1},8,["loading","finished","error"])]),_:1})])]),_:1}),k("div",Se,[r(he,{questions:m.value,isEnd:g},null,8,["questions"])])],64)}}}),Te=R(we,[["__scopeId","data-v-a06bb0f7"]]);export{Te as default};
