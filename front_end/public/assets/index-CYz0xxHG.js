import{q as $,t as ve,v as P,x as z,f as J,y as Y,z as N,A as V,r as w,B as he,C as p,D as oe,E as le,G as ge,H as ae,a as m,I as ie,J as Q,K as _,L as ce,M as be,N as Oe,O as Te,Q as L,R as pe,S as W,T as ke,U as j,V as X,W as ye,e as Ce}from"./index-WXGUVd8R.js";import{r as se}from"./request-BsTyHzWx.js";const[xe,O,Z]=$("picker"),ue=e=>e.find(l=>!l.disabled)||e[0];function Ee(e,l){const o=e[0];if(o){if(Array.isArray(o))return"multiple";if(l.children in o)return"cascade"}return"default"}function B(e,l){l=z(l,0,e.length);for(let o=l;o<e.length;o++)if(!e[o].disabled)return o;for(let o=l-1;o>=0;o--)if(!e[o].disabled)return o;return 0}const ee=(e,l,o)=>l!==void 0&&!!e.find(s=>s[o.value]===l);function G(e,l,o){const s=e.findIndex(f=>f[o.value]===l),i=B(e,s);return e[i]}function we(e,l,o){const s=[];let i={[l.children]:e},f=0;for(;i&&i[l.children];){const v=i[l.children],h=o.value[f];if(i=ve(h)?G(v,h,l):void 0,!i&&v.length){const u=ue(v)[l.value];i=G(v,u,l)}f++,s.push(v)}return s}function Pe(e){const{transform:l}=window.getComputedStyle(e),o=l.slice(7,l.length-1).split(", ")[5];return Number(o)}function Se(e){return P({text:"text",value:"value",children:"children"},e)}const te=200,ne=300,Ie=15,[re,q]=$("picker-column"),me=Symbol(re);var He=J({name:re,props:{value:Y,fields:N(Object),options:V(),readonly:Boolean,allowHtml:Boolean,optionHeight:N(Number),swipeDuration:N(Y),visibleOptionNum:N(Y)},emits:["change","clickOption","scrollInto"],setup(e,{emit:l,slots:o}){let s,i,f,v,h;const u=w(),g=w(),r=w(0),d=w(0),y=he(),C=()=>e.options.length,M=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,k=c=>{let t=B(e.options,c);const n=-t*e.optionHeight,a=()=>{t>C()-1&&(t=B(e.options,c));const T=e.options[t][e.fields.value];T!==e.value&&l("change",T)};s&&n!==r.value?h=a:a(),r.value=n},b=()=>e.readonly||!e.options.length,A=c=>{s||b()||(h=null,d.value=te,k(c),l("clickOption",e.options[c]))},x=c=>z(Math.round(-c/e.optionHeight),0,C()-1),D=p(()=>x(r.value)),K=(c,t)=>{const n=Math.abs(c/t);c=r.value+n/.003*(c<0?-1:1);const a=x(c);d.value=+e.swipeDuration,k(a)},S=()=>{s=!1,d.value=0,h&&(h(),h=null)},U=c=>{if(!b()){if(y.start(c),s){const t=Pe(g.value);r.value=Math.min(0,t-M())}d.value=0,i=r.value,f=Date.now(),v=i,h=null}},F=c=>{if(b())return;y.move(c),y.isVertical()&&(s=!0,ie(c,!0));const t=z(i+y.deltaY.value,-(C()*e.optionHeight),e.optionHeight),n=x(t);n!==D.value&&l("scrollInto",e.options[n]),r.value=t;const a=Date.now();a-f>ne&&(f=a,v=t)},I=()=>{if(b())return;const c=r.value-v,t=Date.now()-f;if(t<ne&&Math.abs(c)>Ie){K(c,t);return}const a=x(r.value);d.value=te,k(a),setTimeout(()=>{s=!1},0)},E=()=>{const c={height:`${e.optionHeight}px`};return e.options.map((t,n)=>{const a=t[e.fields.text],{disabled:T}=t,H=t[e.fields.value],de={role:"button",style:c,tabindex:T?-1:0,class:[q("item",{disabled:T,selected:H===e.value}),t.className],onClick:()=>A(n)},fe={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:a};return m("li",de,[o.option?o.option(t,n):m("div",fe,null)])})};return oe(me),le({stopMomentum:S}),ge(()=>{const c=s?Math.floor(-r.value/e.optionHeight):e.options.findIndex(a=>a[e.fields.value]===e.value),t=B(e.options,c),n=-t*e.optionHeight;s&&t<c&&S(),r.value=n}),ae("touchmove",F,{target:u}),()=>m("div",{ref:u,class:q(),onTouchstartPassive:U,onTouchend:I,onTouchcancel:I},[m("ul",{ref:g,style:{transform:`translate3d(0, ${r.value+M()}px, 0)`,transitionDuration:`${d.value}ms`,transitionProperty:d.value?"all":"none"},class:q("wrapper"),onTransitionend:S},[E()])])}});const[Me]=$("picker-toolbar"),R={title:String,cancelButtonText:String,confirmButtonText:String},De=["cancel","confirm","title","toolbar"],Ne=Object.keys(R);var _e=J({name:Me,props:R,emits:["confirm","cancel"],setup(e,{emit:l,slots:o}){const s=()=>{if(o.title)return o.title();if(e.title)return m("div",{class:[O("title"),"van-ellipsis"]},[e.title])},i=()=>l("cancel"),f=()=>l("confirm"),v=()=>{var u;const g=(u=e.cancelButtonText)!=null?u:Z("cancel");if(!(!o.cancel&&!g))return m("button",{type:"button",class:[O("cancel"),Q],onClick:i},[o.cancel?o.cancel():g])},h=()=>{var u;const g=(u=e.confirmButtonText)!=null?u:Z("confirm");if(!(!o.confirm&&!g))return m("button",{type:"button",class:[O("confirm"),Q],onClick:f},[o.confirm?o.confirm():g])};return()=>m("div",{class:O("toolbar")},[o.toolbar?o.toolbar():[v(),s(),h()]])}});const[Be,Fe]=$("picker-group"),Ve=Symbol(Be);P({tabs:V(),activeTab:_(0),nextStepText:String,showToolbar:ce},R);const $e=P({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:_(44),showToolbar:ce,swipeDuration:_(1e3),visibleOptionNum:_(6)},R),Re=P({},$e,{columns:V(),modelValue:V(),toolbarPosition:be("top"),columnsFieldNames:Object});var Ae=J({name:xe,props:Re,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:l,slots:o}){const s=w(),i=w(e.modelValue.slice(0)),{parent:f}=oe(Ve),{children:v,linkChildren:h}=Oe(me);h();const u=p(()=>Se(e.columnsFieldNames)),g=p(()=>Te(e.optionHeight)),r=p(()=>Ee(e.columns,u.value)),d=p(()=>{const{columns:t}=e;switch(r.value){case"multiple":return t;case"cascade":return we(t,u.value,i);default:return[t]}}),y=p(()=>d.value.some(t=>t.length)),C=p(()=>d.value.map((t,n)=>G(t,i.value[n],u.value))),M=p(()=>d.value.map((t,n)=>t.findIndex(a=>a[u.value.value]===i.value[n]))),k=(t,n)=>{if(i.value[t]!==n){const a=i.value.slice(0);a[t]=n,i.value=a}},b=()=>({selectedValues:i.value.slice(0),selectedOptions:C.value,selectedIndexes:M.value}),A=(t,n)=>{k(n,t),r.value==="cascade"&&i.value.forEach((a,T)=>{const H=d.value[T];ee(H,a,u.value)||k(T,H.length?H[0][u.value.value]:void 0)}),X(()=>{l("change",P({columnIndex:n},b()))})},x=(t,n)=>{const a={columnIndex:n,currentOption:t};l("clickOption",P(b(),a)),l("scrollInto",a)},D=()=>{v.forEach(n=>n.stopMomentum());const t=b();return X(()=>{l("confirm",t)}),t},K=()=>l("cancel",b()),S=()=>d.value.map((t,n)=>m(He,{value:i.value[n],fields:u.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:g.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:a=>A(a,n),onClickOption:a=>x(a,n),onScrollInto:a=>{l("scrollInto",{currentOption:a,columnIndex:n})}},{option:o.option})),U=t=>{if(y.value){const n={height:`${g.value}px`},a={backgroundSize:`100% ${(t-g.value)/2}px`};return[m("div",{class:O("mask"),style:a},null),m("div",{class:[ye,O("frame")],style:n},null)]}},F=()=>{const t=g.value*+e.visibleOptionNum,n={height:`${t}px`};return m("div",{ref:s,class:O("columns"),style:n},[S(),U(t)])},I=()=>{if(e.showToolbar&&!f)return m(_e,ke(W(e,Ne),{onConfirm:D,onCancel:K}),W(o,De))};L(d,t=>{t.forEach((n,a)=>{n.length&&!ee(n,i.value[a],u.value)&&k(a,ue(n)[u.value.value])})},{immediate:!0});let E;return L(()=>e.modelValue,t=>{!j(t,i.value)&&!j(t,E)&&(i.value=t.slice(0),E=t.slice(0))},{deep:!0}),L(i,t=>{j(t,e.modelValue)||(E=t.slice(0),l("update:modelValue",E))},{immediate:!0}),ae("touchmove",ie,{target:s}),le({confirm:D,getSelectedOptions:()=>C.value}),()=>{var t,n;return m("div",{class:O()},[e.toolbarPosition==="top"?I():null,e.loading?m(pe,{class:O("loading")},null):null,(t=o["columns-top"])==null?void 0:t.call(o),F(),(n=o["columns-bottom"])==null?void 0:n.call(o),e.toolbarPosition==="bottom"?I():null])}}});const Ye=Ce(Ae);function Le(e){return se.post("/users/login",e)}function je(e){return se.post("/users/register",e)}export{Ye as P,Le as l,je as r};
